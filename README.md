I modified biria's code a bit to my liking.
